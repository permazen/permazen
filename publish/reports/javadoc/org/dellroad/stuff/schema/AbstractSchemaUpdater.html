<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Wed Nov 12 15:42:05 CST 2014 -->
<title>AbstractSchemaUpdater (Java Class Library API)</title>
<meta name="date" content="2014-11-12">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="AbstractSchemaUpdater (Java Class Library API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractSchemaUpdater.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/dellroad/stuff/schema/AbstractSpringSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/dellroad/stuff/schema/AbstractSchemaUpdater.html" target="_top">Frames</a></li>
<li><a href="AbstractSchemaUpdater.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.dellroad.stuff.schema</div>
<h2 title="Class AbstractSchemaUpdater" class="title">Class AbstractSchemaUpdater&lt;D,T&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.dellroad.stuff.schema.AbstractSchemaUpdater&lt;D,T&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl><dt><span class="strong">Type Parameters:</span></dt><dd><code>D</code> - database type</dd><dd><code>T</code> - database transaction type</dd></dl>
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectSchemaUpdater.html" title="class in org.dellroad.stuff.pobj">PersistentObjectSchemaUpdater</a>, <a href="../../../../org/dellroad/stuff/schema/SQLSchemaUpdater.html" title="class in org.dellroad.stuff.schema">SQLSchemaUpdater</a></dd>
</dl>
<hr>
<br>
<pre>public abstract class <a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.51">AbstractSchemaUpdater</a>&lt;D,T&gt;
extends java.lang.Object</pre>
<div class="block">Handles the initialization and schema maintenance of a database.

 <p>
 In this class, a <b>database</b> is some stateful object whose structure and/or content may need to change over time.
 <b>Updates</b> are uniquely named objects capable of making such changes. Databases are also capable of storing the
 names of the already-applied updates.

 <p>
 Given a database and a set of current updates, this class will ensure that a database is initialized if necessary
 and up-to-date with respect to the updates.

 <p>
 The primary method is <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeAndUpdateDatabase(D)"><code>initializeAndUpdateDatabase()</code></a>, which will:
 <ul>
 <li>Initialize an <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#databaseNeedsInitialization(T)">empty</a> database (if necessary);</li>
 <li>Apply any outstanding <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema"><code>SchemaUpdate</code></a>s as needed, ordered properly according to
      their <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html#getRequiredPredecessors()">predecessor constraints</a>; and</li>
 <li>Keep track of which <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema"><code>SchemaUpdate</code></a>s have already been applied across restarts.</li>
 </ul>
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#log">log</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#AbstractSchemaUpdater()">AbstractSchemaUpdater</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#apply(T, org.dellroad.stuff.schema.DatabaseAction)">apply</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction,
          <a href="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&nbsp;action)</code>
<div class="block">Execute a database action within an existing transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#applyInTransaction(D, org.dellroad.stuff.schema.DatabaseAction)">applyInTransaction</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</a>&nbsp;database,
                                    <a href="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&nbsp;action)</code>
<div class="block">Execute a database action.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)">commitTransaction</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)</code>
<div class="block">Commit a previously opened transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#databaseNeedsInitialization(T)">databaseNeedsInitialization</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)</code>
<div class="block">Determine if the database needs initialization.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#generateMultiUpdateName(org.dellroad.stuff.schema.SchemaUpdate, int)">generateMultiUpdateName</a></strong>(<a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&nbsp;update,
                                              int&nbsp;index)</code>
<div class="block">Generate the update name for one action within a multi-action update.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getAllUpdateNames()">getAllUpdateNames</a></strong>()</code>
<div class="block">Get the names of all updates including multi-action updates.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract java.util.Set&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getAppliedUpdateNames(T)">getAppliedUpdateNames</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)</code>
<div class="block">Determine which updates have already been applied to the database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected java.util.Comparator&lt;<a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getOrderingTieBreaker()">getOrderingTieBreaker</a></strong>()</code>
<div class="block">Determine the preferred ordering of two updates that do not have any predecessor constraints
 (including implied indirect constraints) between them.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.Collection&lt;? extends <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getUpdates()">getUpdates</a></strong>()</code>
<div class="block">Get the configured updates.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeAndUpdateDatabase(D)">initializeAndUpdateDatabase</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</a>&nbsp;database)</code>
<div class="block">Perform database schema initialization and updates.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeDatabase(T)">initializeDatabase</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)</code>
<div class="block">Initialize an uninitialized database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#isIgnoreUnrecognizedUpdates()">isIgnoreUnrecognizedUpdates</a></strong>()</code>
<div class="block">Determine whether unrecognized updates are ignored or cause an exception.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#isValidUpdateName(java.lang.String)">isValidUpdateName</a></strong>(java.lang.String&nbsp;updateName)</code>
<div class="block">Determine if the given schema update name is valid.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#openTransaction(D)">openTransaction</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</a>&nbsp;database)</code>
<div class="block">Begin a transaction on the given database.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#recordUpdateApplied(T, java.lang.String)">recordUpdateApplied</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction,
                                      java.lang.String&nbsp;name)</code>
<div class="block">Record an update as having been applied to the database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected abstract void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#rollbackTransaction(T)">rollbackTransaction</a></strong>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)</code>
<div class="block">Roll back a previously opened transaction.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)">setIgnoreUnrecognizedUpdates</a></strong>(boolean&nbsp;ignoreUnrecognizedUpdates)</code>
<div class="block">Configure behavior when an unknown update is registered as having already been applied in the database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setUpdates(java.util.Collection)">setUpdates</a></strong>(java.util.Collection&lt;? extends <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&gt;&nbsp;updates)</code>
<div class="block">Configure the updates.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>log</h4>
<pre>protected final&nbsp;<a href="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</a> <a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.53">log</a></pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="AbstractSchemaUpdater()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>AbstractSchemaUpdater</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.51">AbstractSchemaUpdater</a>()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getUpdates()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getUpdates</h4>
<pre>public&nbsp;java.util.Collection&lt;? extends <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&gt;&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.64">getUpdates</a>()</pre>
<div class="block">Get the configured updates. This property is required.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>configured updates</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setUpdates(java.util.Collection)"><code>setUpdates()</code></a></dd></dl>
</li>
</ul>
<a name="setUpdates(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setUpdates</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.86">setUpdates</a>(java.util.Collection&lt;? extends <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&gt;&nbsp;updates)</pre>
<div class="block">Configure the updates.
 This should be the set of all updates that may need to be applied to the database.

 <p>
 For any given application, ideally this set should be "write only" in the sense that once an update is added to the set
 and applied to one or more actual databases, the update and its name should thereafter never change. Otherwise,
 it would be possible for different databases to have inconsistent schemas even though the same updates were recorded.

 <p>
 Furthermore, if not configured to <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)">ignore unrecognized updates already applied</a>
 (the default behavior), then updates must never be removed from this set as the application evolves;
 see <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)"><code>setIgnoreUnrecognizedUpdates(boolean)</code></a> for more information on the rationale.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>updates</code> - all updates; each update must have a unique <a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html#getName()"><code>name</code></a>.</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getUpdates()"><code>getUpdates()</code></a>, 
<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)"><code>setIgnoreUnrecognizedUpdates(boolean)</code></a></dd></dl>
</li>
</ul>
<a name="isIgnoreUnrecognizedUpdates()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isIgnoreUnrecognizedUpdates</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.96">isIgnoreUnrecognizedUpdates</a>()</pre>
<div class="block">Determine whether unrecognized updates are ignored or cause an exception.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if unrecognized updates should be ignored, false if they should cause an exception to be thrown</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)"><code>setIgnoreUnrecognizedUpdates()</code></a></dd></dl>
</li>
</ul>
<a name="setIgnoreUnrecognizedUpdates(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setIgnoreUnrecognizedUpdates</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.116">setIgnoreUnrecognizedUpdates</a>(boolean&nbsp;ignoreUnrecognizedUpdates)</pre>
<div class="block">Configure behavior when an unknown update is registered as having already been applied in the database.

 <p>
 The default behavior is <code>false</code>, which results in an exception being thrown. This protects against
 accidental downgrades (i.e., running older code against a database with a newer schema), which are not supported.
 However, this also requires that all updates that might ever possibly have been applied to the database be
 present in the set of configured updates.

 <p>
 Setting this to <code>true</code> will result in unrecognized updates simply being ignored.
 This setting loses the downgrade protection but allows obsolete schema updates to be dropped over time.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>ignoreUnrecognizedUpdates</code> - whether to ignore unrecognized updates</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#isIgnoreUnrecognizedUpdates()"><code>isIgnoreUnrecognizedUpdates()</code></a></dd></dl>
</li>
</ul>
<a name="initializeAndUpdateDatabase(java.lang.Object)">
<!--   -->
</a><a name="initializeAndUpdateDatabase(D)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializeAndUpdateDatabase</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.145">initializeAndUpdateDatabase</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</a>&nbsp;database)
                                 throws java.lang.Exception</pre>
<div class="block">Perform database schema initialization and updates.

 <p>
 This method applies the following logic: if the <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#databaseNeedsInitialization(T)">database needs initialization</a>,
 then <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeDatabase(T)">initialize the database</a> and <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#recordUpdateApplied(T, java.lang.String)">record</a> each update
 as having been applied; otherwise, <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#apply(T, org.dellroad.stuff.schema.DatabaseAction)">apply</a> any <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#getAppliedUpdateNames(T)">unapplied updates</a>
 as needed.

 <p>
 Note this implies the database initialization must initialize the database to its current, up-to-date state
 (with respect to the set of all available updates), not its original, pre-update state.

 <p>
 The database initialization step, and each of the update steps, is <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#applyInTransaction(D, org.dellroad.stuff.schema.DatabaseAction)">performed within
 its own transaction</a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>database</code> - the database to initialize (if necessary) and update</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an update fails</dd>
<dd><code><a href="../../../../org/dellroad/stuff/schema/UnrecognizedUpdateException.html" title="class in org.dellroad.stuff.schema">UnrecognizedUpdateException</a></code> - if this instance is not configured to <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#setIgnoreUnrecognizedUpdates(boolean)">ignore
 unrecognized updates</a> and an unrecognized update has already been applied</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if two configured updates have the same name</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if any configured update has a required predecessor which is not also a configured update
  (i.e., if the updates are not transitively closed under predecessors)</dd></dl>
</li>
</ul>
<a name="isValidUpdateName(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isValidUpdateName</h4>
<pre>public static&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.182">isValidUpdateName</a>(java.lang.String&nbsp;updateName)</pre>
<div class="block">Determine if the given schema update name is valid. Valid names are non-empty and
 have no leading or trailing whitespace.</div>
</li>
</ul>
<a name="databaseNeedsInitialization(java.lang.Object)">
<!--   -->
</a><a name="databaseNeedsInitialization(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>databaseNeedsInitialization</h4>
<pre>protected abstract&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.195">databaseNeedsInitialization</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)
                                                throws java.lang.Exception</pre>
<div class="block">Determine if the database needs initialization.

 <p>
 If so, <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#initializeDatabase(T)"><code>initializeDatabase(T)</code></a> will eventually be invoked.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>transaction</code> - open transaction</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="initializeDatabase(java.lang.Object)">
<!--   -->
</a><a name="initializeDatabase(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializeDatabase</h4>
<pre>protected abstract&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.204">initializeDatabase</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)
                                    throws java.lang.Exception</pre>
<div class="block">Initialize an uninitialized database. This should create and initialize the database schema and content,
 including whatever portion of that is used to track schema updates.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>transaction</code> - open transaction</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="openTransaction(java.lang.Object)">
<!--   -->
</a><a name="openTransaction(D)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>openTransaction</h4>
<pre>protected abstract&nbsp;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.215">openTransaction</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</a>&nbsp;database)
                              throws java.lang.Exception</pre>
<div class="block">Begin a transaction on the given database.
 The transaction will always eventually either be
 <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)">committed</a> or <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#rollbackTransaction(T)">rolled back</a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>database</code> - database</dd>
<dt><span class="strong">Returns:</span></dt><dd>transaction handle</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="commitTransaction(java.lang.Object)">
<!--   -->
</a><a name="commitTransaction(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>commitTransaction</h4>
<pre>protected abstract&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.223">commitTransaction</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)
                                   throws java.lang.Exception</pre>
<div class="block">Commit a previously opened transaction.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>transaction</code> - open transaction previously returned from <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#openTransaction(D)"><code>openTransaction()</code></a></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="rollbackTransaction(java.lang.Object)">
<!--   -->
</a><a name="rollbackTransaction(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rollbackTransaction</h4>
<pre>protected abstract&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.232">rollbackTransaction</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)
                                     throws java.lang.Exception</pre>
<div class="block">Roll back a previously opened transaction.
 This method will also be invoked if <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)"><code>commitTransaction()</code></a> throws an exception.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>transaction</code> - open transaction previously returned from <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#openTransaction(D)"><code>openTransaction()</code></a></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="getAppliedUpdateNames(java.lang.Object)">
<!--   -->
</a><a name="getAppliedUpdateNames(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAppliedUpdateNames</h4>
<pre>protected abstract&nbsp;java.util.Set&lt;java.lang.String&gt;&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.240">getAppliedUpdateNames</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction)
                                                                  throws java.lang.Exception</pre>
<div class="block">Determine which updates have already been applied to the database.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>transaction</code> - open transaction</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="recordUpdateApplied(java.lang.Object,java.lang.String)">
<!--   -->
</a><a name="recordUpdateApplied(T, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordUpdateApplied</h4>
<pre>protected abstract&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.250">recordUpdateApplied</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction,
                       java.lang.String&nbsp;name)
                                     throws java.lang.Exception</pre>
<div class="block">Record an update as having been applied to the database.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>transaction</code> - open transaction</dd><dd><code>name</code> - update name</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if the update has already been recorded in the database</dd>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="getOrderingTieBreaker()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOrderingTieBreaker</h4>
<pre>protected&nbsp;java.util.Comparator&lt;<a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&gt;&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.262">getOrderingTieBreaker</a>()</pre>
<div class="block">Determine the preferred ordering of two updates that do not have any predecessor constraints
 (including implied indirect constraints) between them.

 <p>
 The <code>Comparator</code> returned by the implementation in <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><code>AbstractSchemaUpdater</code></a> simply sorts updates by name.
 Subclasses may override if necessary.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a <code>Comparator</code> that sorts incomparable updates in the order they should be applied</dd></dl>
</li>
</ul>
<a name="generateMultiUpdateName(org.dellroad.stuff.schema.SchemaUpdate, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateMultiUpdateName</h4>
<pre>protected&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.277">generateMultiUpdateName</a>(<a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html" title="interface in org.dellroad.stuff.schema">SchemaUpdate</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&nbsp;update,
                                       int&nbsp;index)</pre>
<div class="block">Generate the update name for one action within a multi-action update.

 <p>
 The implementation in <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><code>AbstractSchemaUpdater</code></a> just adds a suffix using <code>index + 1</code>, padded to
 5 digits, producing names like <code>name-00001</code>, <code>name-00002</code>, etc.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>update</code> - the schema update</dd><dd><code>index</code> - the index of the action (zero based)</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/schema/SchemaUpdate.html#isSingleAction()"><code>SchemaUpdate.isSingleAction()</code></a></dd></dl>
</li>
</ul>
<a name="getAllUpdateNames()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllUpdateNames</h4>
<pre>protected&nbsp;java.util.List&lt;java.lang.String&gt;&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.284">getAllUpdateNames</a>()
                                                      throws java.lang.Exception</pre>
<div class="block">Get the names of all updates including multi-action updates.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd></dl>
</li>
</ul>
<a name="apply(java.lang.Object,org.dellroad.stuff.schema.DatabaseAction)">
<!--   -->
</a><a name="apply(T, org.dellroad.stuff.schema.DatabaseAction)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>apply</h4>
<pre>protected&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.306">apply</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&nbsp;transaction,
         <a href="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&nbsp;action)
              throws java.lang.Exception</pre>
<div class="block">Execute a database action within an existing transaction.

 <p>
 All database operations in <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><code>AbstractSchemaUpdater</code></a> are performed via this method;
 subclasses are encouraged to follow this pattern.

 <p>
 The implementation in <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="class in org.dellroad.stuff.schema"><code>AbstractSchemaUpdater</code></a> simply invokes <a href="../../../../org/dellroad/stuff/schema/DatabaseAction.html#apply(T)"><code>action.apply()</code></a>;
 subclasses may override if desired.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
<a name="applyInTransaction(java.lang.Object,org.dellroad.stuff.schema.DatabaseAction)">
<!--   -->
</a><a name="applyInTransaction(D, org.dellroad.stuff.schema.DatabaseAction)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>applyInTransaction</h4>
<pre>protected&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/schema/AbstractSchemaUpdater.html#line.320">applyInTransaction</a>(<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">D</a>&nbsp;database,
                      <a href="../../../../org/dellroad/stuff/schema/DatabaseAction.html" title="interface in org.dellroad.stuff.schema">DatabaseAction</a>&lt;<a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html" title="type parameter in AbstractSchemaUpdater">T</a>&gt;&nbsp;action)
                           throws java.lang.Exception</pre>
<div class="block">Execute a database action. A new transaction will be created, used, and closed.
 Delegates to <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#apply(T, org.dellroad.stuff.schema.DatabaseAction)"><code>apply()</code></a> for the actual execution of the action.

 <p>
 If the action or <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#commitTransaction(T)"><code>commitTransaction()</code></a> fails, the transaction
 is <a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdater.html#rollbackTransaction(T)">rolled back</a>.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.Exception</code> - if an error occurs while accessing the database</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AbstractSchemaUpdater.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/dellroad/stuff/schema/AbstractSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/dellroad/stuff/schema/AbstractSpringSchemaUpdate.html" title="class in org.dellroad.stuff.schema"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/dellroad/stuff/schema/AbstractSchemaUpdater.html" target="_top">Frames</a></li>
<li><a href="AbstractSchemaUpdater.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
