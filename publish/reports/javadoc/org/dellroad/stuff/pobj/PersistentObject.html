<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Wed Nov 12 15:42:05 CST 2014 -->
<title>PersistentObject (Java Class Library API)</title>
<meta name="date" content="2014-11-12">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PersistentObject (Java Class Library API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PersistentObject.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/dellroad/stuff/pobj/PersistentFileTransaction.html" title="class in org.dellroad.stuff.pobj"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/dellroad/stuff/pobj/PersistentObject.html" target="_top">Frames</a></li>
<li><a href="PersistentObject.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.dellroad.stuff.pobj</div>
<h2 title="Class PersistentObject" class="title">Class PersistentObject&lt;T&gt;</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.dellroad.stuff.pobj.PersistentObject&lt;T&gt;</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl><dt><span class="strong">Type Parameters:</span></dt><dd><code>T</code> - type of the root object</dd></dl>
<hr>
<br>
<pre>public class <a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.209">PersistentObject</a>&lt;T&gt;
extends java.lang.Object</pre>
<div class="block">Main class for Simple XML Persistence Objects (POBJ).

 <h3>Overview</h3>

 <p>
 A <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> instance manages an in-memory database with ACID semantics and strict validation that is
 represented by a regular Java object graph (i.e., a root Java object and all of the other objects that it (indirectly)
 references). The object graph can be (de)serialized to/from XML, and this XML representation is used for persistence
 in the file system. The backing XML file is read in at initialization time and updated after each change.
 </p>

 <p>
 All changes required copying the entire object graph, and are atomic and strictly serialized. In other words, the
 entire object graph is read and written by value. On the filesystem, the persistent XML file
 is updated by writing out a new, temporary copy and renaming the copy onto the original, using <code>File.renameTo()</code> so that changes are also atomic from a filesystem perspective, i.e., it's not possible to open an
 invalid or partial XML file (assuming filesystem renames are atomic, e.g., all UNIX variants). This class also
 supports information flowing in the other direction, where we pick up "out of band" updates to the XML file (see below).
 </p>

 <p>
 This class is most appropriate for use with information that must be carefully controlled and validated,
 but that doesn't change frequently. Configuration information for an application stored in a <code>config.xml</code>
 file is a typical use case; beans whose behavior is determined by the configured information can subclass
 <a href="../../../../org/dellroad/stuff/pobj/AbstractConfiguredBean.html" title="class in org.dellroad.stuff.pobj"><code>AbstractConfiguredBean</code></a> and have their lifecycles managed automatically.
 </p>

 <p>
 Because each change involves copying of the entire graph, an efficient graph copy operation is desirable.
 The <a href="../../../../org/dellroad/stuff/pobj/AbstractDelegate.html#copy(T)">default method</a> is to serialize and then deserialize the object graph
 to/from XML in memory. See <a href="../../../../org/dellroad/stuff/java/GraphCloneable.html" title="interface in org.dellroad.stuff.java"><code>GraphCloneable</code></a> for a much more efficient approach.
 </p>

 <h3>Validation</h3>

 <p>
 Validation is peformed in Java (not in XML) and defined by the provided <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>. This delegate
 guarantees that only a valid root Java object can be read or written. Setting an invalid Java root object via
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a> with throw an exception; reading an invalid XML file on disk will generate
 an error (or be ignored; see "Empty Starts" below).
 </p>

 <h3>Update Details</h3>

 <p>
 When the object graph is updated, it must pass validation checks, and then the persistent XML file is updated and
 listener notifications are sent out. Listeners are always notified in a separate thread from the one that invoked
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a>. Support for delayed write-back of the persistent XML file is included: this
 allows modifications that occur in rapid succession to be consolidated into a single filesystem write operation.
 </p>

 <p>
 Support for optimistic locking is included. There is a "current version" number which is incremented each
 time the object graph is updated; writes may optionally specify this number to ensure no intervening changes
 have occurred. If concurrent updates are expected, applications may choose to implement a 3-way merge algorithm
 of some kind to handle optimistic locking failures.
 </p>

 <p>
 To implement a truly atomic read-modify-write operation without the possibility of locking failure, simply
 synchronize on this instance, e.g.:
  <blockquote><pre>
  synchronized (pobj) {
      MyRoot root = pboj.getRoot();
      root.setFoobar("new value");    // or whatever else we want to modify
      pobj.setRoot(root);
  }
  </pre></blockquote>
 </p>

 <p>
 Instances can also be configured to automatically preserve one or more backup copies of the persistent file on systems that
 support hard links (see <a href="../../../../org/dellroad/stuff/io/FileStreamRepository.html" title="class in org.dellroad.stuff.io"><code>FileStreamRepository</code></a>). Set the <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getNumBackups()"><code>numBackups</code></a> property to enable.
 </p>

 <h3>"Out-of-band" Writes</h3>

 <p>
 When a non-zero <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getCheckInterval()">check interval</a> is configured, instances support "out-of-band" writes
 directly to the XML persistent file by some other process. This can be handy in cases where the other process (perhaps hand
 edits) is updating the persistent file and you want to have the running Java process pick up the changes just as if
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a> had been invoked. In particular, instances will detect the appearance
 of a newly appearing persistent file after has starting without one (see "empty starts" below). In all cases, persistent
 objects must properly validate. To avoid reading a partial file the external process should write the file atomically by
 creating a temporary file and renaming it; however, this race window is small and in any case the problem is self-correcting
 because a partially written XML file will not validate, and so it will be ignored and retried after another
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getCheckInterval()">check interval</a> milliseconds has passed.
 </p>

 <p>
 A special case of this is effected when <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a> is never explicitly invoked
 by the application. Then some other process must be responsible for all database updates via XML file, and this class
 will automatically pick them up, validate them, and send out notifications to listeners.
 </p>

 <h3>Empty Starts and Stops</h3>

 <p>
 An "empty start" occurs when an instance is <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#start()">started</a> but the persistent XML file is either missing,
 does not validate, or cannot be read for some other reason. In such cases, the instance will start with no object graph,
 and <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a> will return null. This situation will correct itself as soon as the object graph is written via
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a> or the persistent file appears (effecting an "out-of-band" update). At that time, <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)">listeners</a> will be notified for the first time, with <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectEvent.html#getOldRoot()"><code>PersistentObjectEvent.getOldRoot()</code></a> returning null.
 </p>

 <p>
 Whether empty starts are allowed is determined by the <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#isAllowEmptyStart()"><code>allowEmptyStart</code></a> property (default
 <code>false</code>). When empty starts are disallowed and the persistent XML file cannot be successfully read,
 then <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#start()"><code>start()</code></a> will instead throw an immediate <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectException</code></a>.
 </p>

 <p>
 Similarly, "empty stops" are allowed when the <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#isAllowEmptyStop()"><code>allowEmptyStop</code></a> property is set to <code>true</code>
 (by default it is <code>false</code>). An "empty stop" occurs when a null value is passed to <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a>
 (note, an invalid XML file appearing on disk does not cause an empty start).
 Subsequent invocations of <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a> will return <code>null</code>. The persistent file is <b>not</b>
 modified when null is passed to <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot(T, long)</code></a>. When empty stops are disallowed, then invoking
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot(T, long)</code></a> with a <code>null</code> object will result in an <code>IllegalArgumentException</code>.
 </p>

 <p>
 Allowing empty starts and/or stops essentially creates an "unconfigured" state represented by a null root object.
 When empty starts and empty stops are both disallowed, there is no "unconfigured" state: once started, <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a>
 can be relied upon to always return a non-null, validated root object.
 </p>

 <p>
 See <a href="../../../../org/dellroad/stuff/pobj/AbstractConfiguredBean.html" title="class in org.dellroad.stuff.pobj"><code>AbstractConfiguredBean</code></a> for a useful superclass that automatically handles starting and stopping
 based on the state of an associated <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a>.
 </p>

 <h3>Shared Roots</h3>

 Each time <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot()</code></a> or <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a> is invoked, a deep copy of the root object
 is made. This prevents external code from changing any node in the "official" object graph held by this instance,
 and allows invokers of <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a> to modify to the returned object graph without affecting other invokers.
 However, there may be cases where this deep copy is an expensive operation in terms of time or memory.
 The <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()"><code>getSharedRoot()</code></a> method can be used in these situations. This method returns the same
 root object each time it is invoked (this shared root is itself a deep copy of the "official" root). Therefore, only
 the very first invocation pays the price of a copy. However, all invokers of <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()"><code>getSharedRoot()</code></a>
 must treat the object graph as read-only to avoid each other seeing unexpected changes.
 </p>

 <h3>Delegate Function</h3>

 <p>
 Instances must be configured with a <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a> that knows how to validate the object graph
 and perform conversions to and from XML. See <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a> and its implementations for details.
 </p>

 <h3>Schema Changes</h3>

 <p>
 Like any database, the XML schema may evolve over time. The <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectSchemaUpdater.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectSchemaUpdater</code></a> class provides a simple
 way to apply and manage schema updates using XSLT transforms.
 </p>

 <h3>Transaction Manager</h3>

 <p>
 If using Spring, consider using a <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectTransactionManager.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectTransactionManager</code></a> for transactional access to a
 <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a>.
 </p></div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>, 
<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectSchemaUpdater.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectSchemaUpdater</code></a>, 
<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectTransactionManager.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectTransactionManager</code></a>, 
<a href="../../../../org/dellroad/stuff/pobj/AbstractConfiguredBean.html" title="class in org.dellroad.stuff.pobj"><code>AbstractConfiguredBean</code></a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>class&nbsp;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">PersistentObject.Snapshot</a></strong></code>
<div class="block">Holds a "snapshot" of a <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> root object along with the version number
 corresponding to the snapshot.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#log">log</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#PersistentObject()">PersistentObject</a></strong>()</code>
<div class="block">Default constructor.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#PersistentObject(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File)">PersistentObject</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
                                java.io.File&nbsp;file)</code>
<div class="block">Simplified constructor configuring for immediate write-back and no persistent file checks.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#PersistentObject(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File, long, long)">PersistentObject</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
                                java.io.File&nbsp;file,
                                long&nbsp;writeDelay,
                                long&nbsp;checkInterval)</code>
<div class="block">Constructor.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)">addListener</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</code>
<div class="block">Add a listener to be notified each time the object graph changes.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#checkFile()">checkFile</a></strong>()</code>
<div class="block">Check the persistent file for an "out-of-band" update.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected javax.xml.transform.Result</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#createResult(java.io.OutputStream, java.io.File)">createResult</a></strong>(java.io.OutputStream&nbsp;output,
                        java.io.File&nbsp;systemId)</code>
<div class="block">Create a <code>Result</code> targeting the given <code>OutputStream</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getCheckInterval()">getCheckInterval</a></strong>()</code>
<div class="block">Get the delay time between periodic checks for changes in the underlying persistent file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getDelegate()">getDelegate</a></strong>()</code>
<div class="block">Get the configured <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.io.File</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getFile()">getFile</a></strong>()</code>
<div class="block">Get the persistent file containing the XML form of the persisted object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getNumBackups()">getNumBackups</a></strong>()</code>
<div class="block">Get the number of backup copies to preserve.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()">getRoot</a></strong>()</code>
<div class="block">Atomically read the root object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">PersistentObject.Snapshot</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRootSnapshot()">getRootSnapshot</a></strong>()</code>
<div class="block">Read the root object (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a>) and its version (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getVersion()"><code>getVersion()</code></a>) in one atomic operation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()">getSharedRoot</a></strong>()</code>
<div class="block">Get a shared copy of the root object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">PersistentObject.Snapshot</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRootSnapshot()">getSharedRootSnapshot</a></strong>()</code>
<div class="block">Read the shared root object (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()"><code>getSharedRoot()</code></a>) and its version (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getVersion()"><code>getVersion()</code></a>)
 in one atomic operation.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getVersion()">getVersion</a></strong>()</code>
<div class="block">Get the version of the current root.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getWriteDelay()">getWriteDelay</a></strong>()</code>
<div class="block">Get the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#hasRoot()">hasRoot</a></strong>()</code>
<div class="block">Determine whether this instance has a non-null root object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#isAllowEmptyStart()">isAllowEmptyStart</a></strong>()</code>
<div class="block">Determine whether this instance should allow an "empty start".</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#isAllowEmptyStop()">isAllowEmptyStop</a></strong>()</code>
<div class="block">Determine whether this instance should allow an "empty stop".</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#isStarted()">isStarted</a></strong>()</code>
<div class="block">Determine whether this instance is started.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#notifyListeners(long, T, T)">notifyListeners</a></strong>(long&nbsp;newVersion,
                              <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;oldRoot,
                              <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</code>
<div class="block">Notify listeners of a change in value.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read()">read</a></strong>()</code>
<div class="block">Read the persistent file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File, boolean)">read</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
        java.io.File&nbsp;file,
        boolean&nbsp;validate)</code>
<div class="block">Read in a persistent object from the given <code>File</code> using the given delegate.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.InputStream, boolean)">read</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
        java.io.InputStream&nbsp;input,
        boolean&nbsp;validate)</code>
<div class="block">Read in a persistent object from the given <code>InputStream</code> using the given delegate.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;T</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read(org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Source, boolean)">read</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
        javax.xml.transform.Source&nbsp;source,
        boolean&nbsp;validate)</code>
<div class="block">Read in a persistent object using the given delegate.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#removeListener(org.dellroad.stuff.pobj.PersistentObjectListener)">removeListener</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</code>
<div class="block">Remove a listener added via <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)"><code>addListener()</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setAllowEmptyStart(boolean)">setAllowEmptyStart</a></strong>(boolean&nbsp;allowEmptyStart)</code>
<div class="block">Configure whether an "empty start" is allowed.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setAllowEmptyStop(boolean)">setAllowEmptyStop</a></strong>(boolean&nbsp;allowEmptyStop)</code>
<div class="block">Configure whether an "empty stop" is allowed.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setCheckInterval(long)">setCheckInterval</a></strong>(long&nbsp;checkInterval)</code>
<div class="block">Set the delay time between periodic checks for changes in the underlying persistent file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setDelegate(org.dellroad.stuff.pobj.PersistentObjectDelegate)">setDelegate</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate)</code>
<div class="block">Configure the <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setFile(java.io.File)">setFile</a></strong>(java.io.File&nbsp;file)</code>
<div class="block">Set the persistent file containing the XML form of the persisted object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setNumBackups(int)">setNumBackups</a></strong>(int&nbsp;numBackups)</code>
<div class="block">Set the number of backup copies to preserve.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T)">setRoot</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</code>
<div class="block">Atomically update the root object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)">setRoot</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot,
              long&nbsp;expectedVersion)</code>
<div class="block">Atomically update the root object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setWriteDelay(long)">setWriteDelay</a></strong>(long&nbsp;writeDelay)</code>
<div class="block">Set the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#start()">start</a></strong>()</code>
<div class="block">Start this instance.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#stop()">stop</a></strong>()</code>
<div class="block">Stop this instance.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#toString()">toString</a></strong>()</code>
<div class="block">Get a simple string description of this instance.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T)">write</a></strong>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;obj)</code>
<div class="block">Write the persistent file and rotate any backups.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File)">write</a></strong>(T&nbsp;root,
          <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
          java.io.File&nbsp;file)</code>
<div class="block">Write a persistent object using the given delegate.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.OutputStream)">write</a></strong>(T&nbsp;root,
          <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
          java.io.OutputStream&nbsp;output)</code>
<div class="block">Write a persistent object using the given delegate.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static &lt;T&gt;&nbsp;void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Result)">write</a></strong>(T&nbsp;root,
          <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
          javax.xml.transform.Result&nbsp;result)</code>
<div class="block">Write a persistent object using the given delegate.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="log">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>log</h4>
<pre>protected final&nbsp;<a href="http://www.slf4j.org/api/org/slf4j/Logger.html?is-external=true" title="class or interface in org.slf4j">Logger</a> <a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.213">log</a></pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="PersistentObject(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File, long, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PersistentObject</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.248">PersistentObject</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
                java.io.File&nbsp;file,
                long&nbsp;writeDelay,
                long&nbsp;checkInterval)</pre>
<div class="block">Constructor.

 <p>
 The <code>writeDelay</code> is the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>file</code> - the file used to persist</dd><dd><code>writeDelay</code> - write delay in milliseconds, or zero for immediate write-back</dd><dd><code>checkInterval</code> - check interval in milliseconds, or zero to disable persistent file checks</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>delegate</code> or <code>file</code> is null</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>writeDelay</code> or <code>checkInterval</code> is negative</dd></dl>
</li>
</ul>
<a name="PersistentObject(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PersistentObject</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.264">PersistentObject</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate,
                java.io.File&nbsp;file)</pre>
<div class="block">Simplified constructor configuring for immediate write-back and no persistent file checks.

 <p>
 Equivalent to:
 <blockquote><code>
  PersistentObject(delegate, file, 0L, 0L);
 </code></blockquote></div>
</li>
</ul>
<a name="PersistentObject()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>PersistentObject</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.271">PersistentObject</a>()</pre>
<div class="block">Default constructor. Caller must still configure the delegate and persistent file prior to start.</div>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getDelegate()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDelegate</h4>
<pre>public&nbsp;<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.279">getDelegate</a>()</pre>
<div class="block">Get the configured <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the delegate supplying required operations</dd></dl>
</li>
</ul>
<a name="setDelegate(org.dellroad.stuff.pobj.PersistentObjectDelegate)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setDelegate</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.290">setDelegate</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;delegate)</pre>
<div class="block">Configure the <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj"><code>PersistentObjectDelegate</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>delegate</code> - delegate supplying required operations</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>delegate</code> is null</dd>
<dd><code>java.lang.IllegalStateException</code> - if this instance is started</dd></dl>
</li>
</ul>
<a name="getFile()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFile</h4>
<pre>public&nbsp;java.io.File&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.303">getFile</a>()</pre>
<div class="block">Get the persistent file containing the XML form of the persisted object.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>file used to persist the root object</dd></dl>
</li>
</ul>
<a name="setFile(java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.314">setFile</a>(java.io.File&nbsp;file)</pre>
<div class="block">Set the persistent file containing the XML form of the persisted object.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>file</code> - the file used to persist the root object</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>file</code> is null</dd>
<dd><code>java.lang.IllegalStateException</code> - if this instance is started</dd></dl>
</li>
</ul>
<a name="getWriteDelay()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWriteDelay</h4>
<pre>public&nbsp;long&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.328">getWriteDelay</a>()</pre>
<div class="block">Get the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>write delay in milliseconds, or zero for immediate write-back</dd></dl>
</li>
</ul>
<a name="setWriteDelay(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setWriteDelay</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.340">setWriteDelay</a>(long&nbsp;writeDelay)</pre>
<div class="block">Set the maximum delay after an update operation before a write-back to the persistent file
 must be initiated.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>writeDelay</code> - write delay in milliseconds, or zero for immediate write-back</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>writeDelay</code> is negative</dd>
<dd><code>java.lang.IllegalStateException</code> - if this instance is started</dd></dl>
</li>
</ul>
<a name="getCheckInterval()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCheckInterval</h4>
<pre>public&nbsp;long&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.353">getCheckInterval</a>()</pre>
<div class="block">Get the delay time between periodic checks for changes in the underlying persistent file.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>check interval in milliseconds, or zero if periodic checks are disabled</dd></dl>
</li>
</ul>
<a name="setCheckInterval(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCheckInterval</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.364">setCheckInterval</a>(long&nbsp;checkInterval)</pre>
<div class="block">Set the delay time between periodic checks for changes in the underlying persistent file.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>checkInterval</code> - check interval in milliseconds, or zero if periodic checks are disabled</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>writeDelay</code> is negative</dd>
<dd><code>java.lang.IllegalStateException</code> - if this instance is started</dd></dl>
</li>
</ul>
<a name="getVersion()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVersion</h4>
<pre>public&nbsp;long&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.382">getVersion</a>()</pre>
<div class="block">Get the version of the current root.

 <p>
 This returns a value which increases monotonically with each update.
 The version number is not persisted with the persistent file; each instance of this class keeps
 its own version count. The version is reset to zero when <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#stop()"><code>stop()</code></a> is invoked.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the current positive object version, or zero if no value has been loaded yet or this instance is not started</dd></dl>
</li>
</ul>
<a name="getNumBackups()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNumBackups</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.399">getNumBackups</a>()</pre>
<div class="block">Get the number of backup copies to preserve.

 <p>
 Backup files have suffixes of the form <code>.1</code>,  <code>.2</code>, etc.,
 in reverse chronological order. Each time a new root object is written, the existing files are rotated.

 <p>
 Back-ups are created via hard links and are only supported on UNIX systems.

 <p>
 The default is zero, which disables backups.</div>
</li>
</ul>
<a name="setNumBackups(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNumBackups</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.410">setNumBackups</a>(int&nbsp;numBackups)</pre>
<div class="block">Set the number of backup copies to preserve.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>numBackups</code> is negative</dd>
<dd><code>java.lang.IllegalStateException</code> - if no persistent file has been configured yet</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getNumBackups()"><code>getNumBackups()</code></a></dd></dl>
</li>
</ul>
<a name="isAllowEmptyStart()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isAllowEmptyStart</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.422">isAllowEmptyStart</a>()</pre>
<div class="block">Determine whether this instance should allow an "empty start".

 <p>
 The default for this property is false.</div>
</li>
</ul>
<a name="setAllowEmptyStart(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAllowEmptyStart</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.434">setAllowEmptyStart</a>(boolean&nbsp;allowEmptyStart)</pre>
<div class="block">Configure whether an "empty start" is allowed.

 <p>
 The default for this property is false.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is started</dd></dl>
</li>
</ul>
<a name="isAllowEmptyStop()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isAllowEmptyStop</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.446">isAllowEmptyStop</a>()</pre>
<div class="block">Determine whether this instance should allow an "empty stop".

 <p>
 The default for this property is false.</div>
</li>
</ul>
<a name="setAllowEmptyStop(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAllowEmptyStop</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.458">setAllowEmptyStop</a>(boolean&nbsp;allowEmptyStop)</pre>
<div class="block">Configure whether an "empty stop" is allowed.

 <p>
 The default for this property is false.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is started</dd></dl>
</li>
</ul>
<a name="isStarted()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isStarted</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.467">isStarted</a>()</pre>
<div class="block">Determine whether this instance is started.</div>
</li>
</ul>
<a name="start()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.476">start</a>()</pre>
<div class="block">Start this instance. Does nothing if already started.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="stop()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stop</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.548">stop</a>()</pre>
<div class="block">Stop this instance. Does nothing if already stopped.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if a delayed write back is pending and error occurs while performing the write</dd></dl>
</li>
</ul>
<a name="hasRoot()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasRoot</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.581">hasRoot</a>()</pre>
<div class="block">Determine whether this instance has a non-null root object.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if this instance has a non-null root object, false if this instance is not started
  or is in an empty start or empty stop state</dd></dl>
</li>
</ul>
<a name="getRoot()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRoot</h4>
<pre>public&nbsp;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.602">getRoot</a>()</pre>
<div class="block">Atomically read the root object.

 <p>
 In the situation of an empty start or empty stop, this instance is "unconfigured" and null will be returned.
 This can only happen if <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setAllowEmptyStart(boolean)"><code>setAllowEmptyStart(true)</code></a> or <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setAllowEmptyStop(boolean)"><code>setAllowEmptyStop(true)</code></a> has been invoked.

 <p>
 This returns a deep copy of the current root object; any subsequent modifications are not written back.
 Use <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()"><code>getSharedRoot()</code></a> instead to avoid the cost of the deep copy at the risk of seeing modifications
 caused by other invokers.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the current root instance, or null during an empty start or empty stop</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is not started</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="getSharedRoot()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSharedRoot</h4>
<pre>public&nbsp;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.623">getSharedRoot</a>()</pre>
<div class="block">Get a shared copy of the root object.

 <p>
 This returns a copy of the root object, but it returns the same copy each time until the next change.
 This method is more efficient than <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a>, but all callers must agree not to modify the returned object
 or any object in its graph of references.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>shared copy of the root instance, or null during an empty start or empty stop</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is not started</dd></dl>
</li>
</ul>
<a name="getRootSnapshot()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRootSnapshot</h4>
<pre>public&nbsp;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">PersistentObject.Snapshot</a>&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.638">getRootSnapshot</a>()</pre>
<div class="block">Read the root object (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a>) and its version (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getVersion()"><code>getVersion()</code></a>) in one atomic operation.
 This avoids the race condition inherent in trying to perform these operations separately.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>snapshot of the current root, or null during an empty start or empty stop</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is not started</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a></dd></dl>
</li>
</ul>
<a name="getSharedRootSnapshot()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getSharedRootSnapshot</h4>
<pre>public&nbsp;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj">PersistentObject.Snapshot</a>&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.655">getSharedRootSnapshot</a>()</pre>
<div class="block">Read the shared root object (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()"><code>getSharedRoot()</code></a>) and its version (as with <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getVersion()"><code>getVersion()</code></a>)
 in one atomic operation.
 This avoids the race condition inherent in trying to perform these operations separately.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>snapshot of the current shared root, or null during an empty start or empty stop</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is not started</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getSharedRoot()"><code>getSharedRoot()</code></a></dd></dl>
</li>
</ul>
<a name="setRoot(java.lang.Object,long)">
<!--   -->
</a><a name="setRoot(T, long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRoot</h4>
<pre>public final&nbsp;long&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.705">setRoot</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot,
           long&nbsp;expectedVersion)</pre>
<div class="block">Atomically update the root object.

 <p>
 The given object is deep-copied, the copy replaces the current root, and the new version number is returned.
 If there is no write delay configured, the new version is written to the underlying file immediately and
 a successful return from this method indicates the new root has been persisted. Otherwise, the write will
 occur at a later time in a separate thread.
 </p>

 <p>
 If <code>expectedVersion</code> is non-zero, then if the current version is not equal to it,
 a <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectVersionException</code></a> exception is thrown. This mechanism
 can be used for optimistic locking.
 </p>

 <p>
 If empty stops are allowed, then <code>newRoot</code> may be null, in which case it replaces the
 current root and subsequent calls to <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#getRoot()"><code>getRoot()</code></a> will return null. When a null
 <code>newRoot</code> is set, the persistent file is <b>not</b> modified.
 </p>

 <p>
 If the given root object is <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html#isSameGraph(T, T)">the same as</a> the current
 root object, then no action is taken and the current (unchanged) version number is returned.
 </p>

 <p>
 After a successful change, any registered <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">listeners</a> are notified in a
 separate thread from the one that invoked this method.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>newRoot</code> - new persistent object</dd><dd><code>expectedVersion</code> - expected current version number, or zero to ignore the current version number</dd>
<dt><span class="strong">Returns:</span></dt><dd>the new current version number (unchanged if <code>newRoot</code> is
  <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html#isSameGraph(T, T)">the same as</a> the current root)</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>newRoot</code> is null and empty stops are disallowed</dd>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>expectedVersion</code> is negative</dd>
<dd><code>java.lang.IllegalStateException</code> - if this instance is not started</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectVersionException</a></code> - if <code>expectedVersion</code> is non-zero and not equal to the current version</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if the new root has validation errors</dd></dl>
</li>
</ul>
<a name="setRoot(java.lang.Object)">
<!--   -->
</a><a name="setRoot(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setRoot</h4>
<pre>public final&nbsp;long&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.776">setRoot</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</pre>
<div class="block">Atomically update the root object.

 <p>
 The is a convenience method, equivalent to:
  <blockquote>
  <code><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#setRoot(T, long)"><code>setRoot</code></a>(newRoot, 0)</code>
  </blockquote>

 <p>
 This method cannot throw <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectVersionException.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObjectVersionException</code></a>.</div>
</li>
</ul>
<a name="checkFile()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.790">checkFile</a>()</pre>
<div class="block">Check the persistent file for an "out-of-band" update.

 <p>
 If the persistent file has a newer timestamp than the timestamp of the most recently read
 or written version, then it will be read and applied to this instance.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - if this instance is not started</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="addListener(org.dellroad.stuff.pobj.PersistentObjectListener)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addListener</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.818">addListener</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</pre>
<div class="block">Add a listener to be notified each time the object graph changes.

 <p>
 Listeners are notified in a separate thread from the one that caused the root object to change.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>listener</code> is null</dd></dl>
</li>
</ul>
<a name="removeListener(org.dellroad.stuff.pobj.PersistentObjectListener)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeListener</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.829">removeListener</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectListener.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectListener</a>&lt;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&gt;&nbsp;listener)</pre>
<div class="block">Remove a listener added via <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#addListener(org.dellroad.stuff.pobj.PersistentObjectListener)"><code>addListener()</code></a>.</div>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.839">toString</a>()</pre>
<div class="block">Get a simple string description of this instance. This description appears in all log messages.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code>toString</code>&nbsp;in class&nbsp;<code>java.lang.Object</code></dd>
</dl>
</li>
</ul>
<a name="read()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>protected&nbsp;<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.849">read</a>()</pre>
<div class="block">Read the persistent file. Does not validate it.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if the file does not exist or cannot be read</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="write(java.lang.Object)">
<!--   -->
</a><a name="write(T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>write</h4>
<pre>protected final&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.886">write</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;obj)</pre>
<div class="block">Write the persistent file and rotate any backups.

 <p>
 A temporary file is created in the same directory and then renamed to provide for an atomic update
 (on supporting operating systems).
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>obj</code> - root object to write</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if <code>obj</code> is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="createResult(java.io.OutputStream, java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createResult</h4>
<pre>protected&nbsp;javax.xml.transform.Result&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.938">createResult</a>(java.io.OutputStream&nbsp;output,
                                      java.io.File&nbsp;systemId)</pre>
<div class="block">Create a <code>Result</code> targeting the given <code>OutputStream</code>.

 <p>
 The implementation in <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> creates and returns a <code>StreamResult</code>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>output</code> - XML output stream</dd><dd><code>systemId</code> - system ID</dd></dl>
</li>
</ul>
<a name="notifyListeners(long,java.lang.Object,java.lang.Object)">
<!--   -->
</a><a name="notifyListeners(long, T, T)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>notifyListeners</h4>
<pre>protected&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.949">notifyListeners</a>(long&nbsp;newVersion,
                   <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;oldRoot,
                   <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="type parameter in PersistentObject">T</a>&nbsp;newRoot)</pre>
<div class="block">Notify listeners of a change in value.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>newVersion</code> - the version number associated with the new root</dd></dl>
</li>
</ul>
<a name="read(org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Source, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;T&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.1070">read</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
         javax.xml.transform.Source&nbsp;source,
         boolean&nbsp;validate)</pre>
<div class="block">Read in a persistent object using the given delegate.

 <p>
 This is a convenience method that can be used for a one-time deserialization from an XML <code>Source</code> without having
 to go through the whole <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> lifecycle.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>source</code> - source for serialized root object</dd><dd><code>validate</code> - whether to also validate the root object</dd>
<dt><span class="strong">Returns:</span></dt><dd>deserialized root object, never null</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if any parameter is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if <code>validate</code> is true and the deserialized root has validation errors</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="read(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;T&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.1118">read</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
         java.io.File&nbsp;file,
         boolean&nbsp;validate)</pre>
<div class="block">Read in a persistent object from the given <code>File</code> using the given delegate.

 <p>
 This is a wrapper around <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read(org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Source, boolean)"><code>read(PersistentObjectDelegate, Source, boolean)</code></a> that handles
 opening and closing the given <code>File</code>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>file</code> - file to read from</dd><dd><code>validate</code> - whether to also validate the root object</dd>
<dt><span class="strong">Returns:</span></dt><dd>deserialized root object, never null</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if any parameter is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if <code>validate</code> is true and the deserialized root has validation errors</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if <code>file</code> cannot be read</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="read(org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.InputStream, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>read</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;T&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.1162">read</a>(<a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
         java.io.InputStream&nbsp;input,
         boolean&nbsp;validate)</pre>
<div class="block">Read in a persistent object from the given <code>InputStream</code> using the given delegate.

 <p>
 This is a wrapper around <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#read(org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Source, boolean)"><code>read(PersistentObjectDelegate, Source, boolean)</code></a>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>input</code> - input to read from</dd><dd><code>validate</code> - whether to also validate the root object</dd>
<dt><span class="strong">Returns:</span></dt><dd>deserialized root object, never null</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if any parameter is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectValidationException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectValidationException</a></code> - if <code>validate</code> is true and the deserialized root has validation errors</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an I/O error occurs</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="write(java.lang.Object,org.dellroad.stuff.pobj.PersistentObjectDelegate,javax.xml.transform.Result)">
<!--   -->
</a><a name="write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Result)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>write</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.1186">write</a>(T&nbsp;root,
             <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
             javax.xml.transform.Result&nbsp;result)</pre>
<div class="block">Write a persistent object using the given delegate.

 <p>
 This is a convenience method that can be used for one-time serialization to an XML <code>Result</code> without having
 to go through the whole <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html" title="class in org.dellroad.stuff.pobj"><code>PersistentObject</code></a> lifecycle.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>root</code> - root object to serialize</dd><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>result</code> - destination</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if any parameter is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="write(java.lang.Object,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.File)">
<!--   -->
</a><a name="write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>write</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.1218">write</a>(T&nbsp;root,
             <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
             java.io.File&nbsp;file)</pre>
<div class="block">Write a persistent object using the given delegate.

 <p>
 This is a wrapper around <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Result)"><code>write(Object, PersistentObjectDelegate, Result)</code></a> that handles
 opening and closing the given <code>File</code>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>root</code> - root object to serialize</dd><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>file</code> - destination file</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if any parameter is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
<a name="write(java.lang.Object,org.dellroad.stuff.pobj.PersistentObjectDelegate,java.io.OutputStream)">
<!--   -->
</a><a name="write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, java.io.OutputStream)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>write</h4>
<pre>public static&nbsp;&lt;T&gt;&nbsp;void&nbsp;<a href="../../../../src-html/org/dellroad/stuff/pobj/PersistentObject.html#line.1253">write</a>(T&nbsp;root,
             <a href="../../../../org/dellroad/stuff/pobj/PersistentObjectDelegate.html" title="interface in org.dellroad.stuff.pobj">PersistentObjectDelegate</a>&lt;T&gt;&nbsp;delegate,
             java.io.OutputStream&nbsp;output)</pre>
<div class="block">Write a persistent object using the given delegate.

 <p>
 This is a wrapper around <a href="../../../../org/dellroad/stuff/pobj/PersistentObject.html#write(T, org.dellroad.stuff.pobj.PersistentObjectDelegate, javax.xml.transform.Result)"><code>write(Object, PersistentObjectDelegate, Result)</code></a>.
 </p></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>root</code> - root object to serialize</dd><dd><code>delegate</code> - delegate supplying required operations</dd><dd><code>output</code> - XML destination</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code> - if any parameter is null</dd>
<dd><code><a href="../../../../org/dellroad/stuff/pobj/PersistentObjectException.html" title="class in org.dellroad.stuff.pobj">PersistentObjectException</a></code> - if an error occurs</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PersistentObject.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/dellroad/stuff/pobj/PersistentFileTransaction.html" title="class in org.dellroad.stuff.pobj"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../org/dellroad/stuff/pobj/PersistentObject.Snapshot.html" title="class in org.dellroad.stuff.pobj"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/dellroad/stuff/pobj/PersistentObject.html" target="_top">Frames</a></li>
<li><a href="PersistentObject.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_class_summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
