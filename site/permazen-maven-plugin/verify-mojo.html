<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from target/generated-site/xdoc/verify-mojo.xml at 2023-04-04

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <title>Permazen Maven Plugin &#x2013; permazen:verify</title>
    <link rel="stylesheet" href="./css/maven-base.css" />
    <link rel="stylesheet" href="./css/maven-theme.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">Permazen Maven Plugin
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2023-04-04</span>
          &#xA0;| <span id="projectVersion">Version: 4.2.0</span>
      </div>
      <div class="xright"><a href="./" title="Permazen Maven Plugin">Permazen Maven Plugin</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Parent Project</h5>
    <ul>
     <li class="none"><a href="../index.html" title="Permazen">Permazen</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="collapsed"><a href="project-reports.html" title="Project Reports">Project Reports</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">

  
    <section>
<h2><a name="permazen:verify"></a>permazen:verify</h2>
      
<p><b>Full name</b>:</p>
      
<p>io.permazen:permazen-maven-plugin:4.2.0:verify</p>
      
<p><b>Description</b>:</p>
      
<div>Verify the Permazen schema auto-generated from user-supplied model
classes. 

<p>This goal verifies that the Permazen schema can be successfully
auto-generated from user-supplied model classes. It also checks
that the schema will not lead to any
<code>SchemaMismatchException</code>s at runtime.</p>

<p>Such exceptions occur when either:</p>

<ul>

<li>There is already a schema recorded in the database under the
configured schema version, but the current schema version is not
compatible with it; or</li>

<li>The current schema version conflicts with one or more other
schema versions recorded in the database, e.g., because an indexed
field has changed its type.</li>
</ul>

<p>The first case is detected by having an expected schema XML
file. This file should correspond to the project's current schema
version, and is is used to verify that the schema auto-generated
from the project's model classes is still &quot;same version&quot; compatible
with this schema version, ensuring no mismatch error will occur at
runtime. In other words, the actual schema generated from the
compiled classes is verified to match what is expected, which is
recorded in this file. The current expected schema XML file
location is configured by
<code>&lt;expectedSchemaFile&gt;</code>;</p>

<p>The second case it detected by supplying XML files containing
any old schema versions that are still active in the old schema
files directory. All files ending in <code>.xml</code> found
anywhere under this directory are checked for &quot;different version&quot;
incompatibilities with the current schema version. The old schema
XML files directory is configured by
<code>&lt;oldSchemasDirectory&gt;</code>.</p>

<p>If this goal fails due to an incompatibility of the first
type:</p>

<ul>

<li>The old expected schema XML file should be moved into the old
schemas directory;</li>

<li>the new expected schema XML file (found in the location
configured by <code>&lt;actualSchemaFile&gt;</code>) should be
copied to the current expected schema XML file;</li>

<li>Any manually configured Permazen schema version number should
be incremented.</li>
</ul>

<p>If this goal fails due to an incompatibility of the second type,
you must adjust your model classes to make them compatible again.
For example, manually reassign a conflicting field a different
<code>name()</code> or <code>storageId()</code> using the
<code>JField</code> annotation.</p></div>
      
<p><b>Attributes</b>:</p>
      
<ul>
        
<li>Requires a Maven project to be executed.</li>
        
<li>Requires dependency resolution of artifacts in scope: <code>compile+runtime</code>.</li>
        
<li>Binds by default to the <a class="externalLink" href="http://maven.apache.org/ref/current/maven-core/lifecycles.html">lifecycle phase</a>: <code>process-classes</code>.</li>
      </ul>
      <section>
<h3><a name="Optional_Parameters"></a>Optional Parameters</h3>
        
<table class="bodyTable" border="0">
          
<tr class="a">
            
<th>Name</th>
            
<th>Type</th>
            
<th>Since</th>
            
<th>Description</th>
          </tr>
          
<tr class="b">
            
<td><code><a href="#actualSchemaFile">&lt;actualSchemaFile&gt;</a></code></td>
            
<td><code>File</code></td>
            
<td><code>-</code></td>
            
<td>The schema XML file generated by this goal that contains the actual
current schema.<br /><b>Default value is</b>: <code>${project.build.directory}/actual-permazen-schema.xml</code>.<br /><b>User property is</b>: <code>actualSchemaFile</code>.<br /></td>
          </tr>
          
<tr class="a">
            
<td><code><a href="#autoGenerate">&lt;autoGenerate&gt;</a></code></td>
            
<td><code>boolean</code></td>
            
<td><code>-</code></td>
            
<td>Whether to automatically generate the expected schema file if it
does not already exist. If set to <code>false</code>, this goal
will fail instead and leave the actual schema XML file in the
<code>&lt;actualSchemaFile&gt;</code> location.<br /><b>Default value is</b>: <code>true</code>.<br /></td>
          </tr>
          
<tr class="b">
            
<td><code><a href="#classes">&lt;classes&gt;</a></code></td>
            
<td><code>String[]</code></td>
            
<td><code>-</code></td>
            
<td>Specifies the names of specific Java classes to search for
@<code>PermazenType</code> or @<code>JFieldType</code> annotations.


<p>If no <code>&lt;classes&gt;</code> or
<code>&lt;packages&gt;</code> are configured, then by default this
plugin searches all classes in the output directory.</p><br /></td>
          </tr>
          
<tr class="a">
            
<td><code><a href="#expectedSchemaFile">&lt;expectedSchemaFile&gt;</a></code></td>
            
<td><code>File</code></td>
            
<td><code>-</code></td>
            
<td>The schema XML file that contains the expected current schema.<br /><b>Default value is</b>: <code>${basedir}/src/main/permazen/current-schema.xml</code>.<br /><b>User property is</b>: <code>expectedSchemaFile</code>.<br /></td>
          </tr>
          
<tr class="b">
            
<td><code><a href="#matchNames">&lt;matchNames&gt;</a></code></td>
            
<td><code>boolean</code></td>
            
<td><code>-</code></td>
            
<td>Whether to verify not only schema compatibility but also that the
two schemas are identical, i.e., the same names are used for object
types, fields, and composite indexes. 

<p>Two schemas that are equivalent except for names are considered
compatible, because the core API uses storage ID's, not names, to
encode fields. However, if names change then some Permazen layer
operations, such as index queries and reference path inversion, may
need to be updated.</p><br /><b>Default value is</b>: <code>true</code>.<br /></td>
          </tr>
          
<tr class="a">
            
<td><code><a href="#oldSchemasDirectory">&lt;oldSchemasDirectory&gt;</a></code></td>
            
<td><code>File</code></td>
            
<td><code>-</code></td>
            
<td>The directory containing old schema versions still in use in any
existing databases.<br /><b>Default value is</b>: <code>${basedir}/src/main/permazen/old</code>.<br /><b>User property is</b>: <code>oldSchemasDirectory</code>.<br /></td>
          </tr>
          
<tr class="b">
            
<td><code><a href="#packages">&lt;packages&gt;</a></code></td>
            
<td><code>String[]</code></td>
            
<td><code>-</code></td>
            
<td>Specifies Java package names under which to search for classes with
@<code>PermazenType</code> or @<code>JFieldType</code> annotations.


<p>If no <code>&lt;classes&gt;</code> or
<code>&lt;packages&gt;</code> are configured, then by default this
plugin searches all classes in the output directory.</p><br /></td>
          </tr>
          
<tr class="a">
            
<td><code><a href="#schemaVersionProperty">&lt;schemaVersionProperty&gt;</a></code></td>
            
<td><code>String</code></td>
            
<td><code>-</code></td>
            
<td>The name of a Maven property to set to the auto-generated schema
version number. This is the schema version number that will be
auto-generated when a schema version number of <code>-1</code> is
configured. This auto-generated version number is based on hashing
the generated schema.<br /></td>
          </tr>
          
<tr class="b">
            
<td><code><a href="#storageIdGeneratorClass">&lt;storageIdGeneratorClass&gt;</a></code></td>
            
<td><code>String</code></td>
            
<td><code>-</code></td>
            
<td>
<p>The <code>StorageIdGenerator</code> to use for generating
Permazen storage ID's. By default, a
<code>DefaultStorageIdGenerator</code> is used.</p>

<p>To configure a custom <code>StorageIdGenerator</code>, specify
its class name like this:</p>

<blockquote>

<div>
<pre>
&lt;configuration&gt;
    &lt;storageIdGeneratorClass&gt;com.example.MyStorageIdGenerator&lt;/storageIdGeneratorClass&gt;
    ...
&lt;/configuration&gt;
</pre></div>
</blockquote>
The specified class (<code>com.example.MyStorageIdGenerator</code>
in this example) must be available either as part of the project
being built or in one of the project's dependencies.<br /></td>
          </tr>
        </table>
      </section>
      <section>
<h3><a name="Parameter_Details"></a>Parameter Details</h3>
        <section>
<h4><a name="a.3CactualSchemaFile.3E"></a><b><a name="actualSchemaFile">&lt;actualSchemaFile&gt;</a></b></h4>
        
<div>The schema XML file generated by this goal that contains the actual
current schema.</div>
        
<ul>
          
<li><b>Type</b>: <code>java.io.File</code></li>
          
<li><b>Required</b>: <code>No</code></li>
          
<li><b>User Property</b>: <code>actualSchemaFile</code></li>
          
<li><b>Default</b>: <code>${project.build.directory}/actual-permazen-schema.xml</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3CautoGenerate.3E"></a><b><a name="autoGenerate">&lt;autoGenerate&gt;</a></b></h4>
        
<div>Whether to automatically generate the expected schema file if it
does not already exist. If set to <code>false</code>, this goal
will fail instead and leave the actual schema XML file in the
<code>&lt;actualSchemaFile&gt;</code> location.</div>
        
<ul>
          
<li><b>Type</b>: <code>boolean</code></li>
          
<li><b>Required</b>: <code>No</code></li>
          
<li><b>Default</b>: <code>true</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3Cclasses.3E"></a><b><a name="classes">&lt;classes&gt;</a></b></h4>
        
<div>Specifies the names of specific Java classes to search for
@<code>PermazenType</code> or @<code>JFieldType</code> annotations.


<p>If no <code>&lt;classes&gt;</code> or
<code>&lt;packages&gt;</code> are configured, then by default this
plugin searches all classes in the output directory.</p></div>
        
<ul>
          
<li><b>Type</b>: <code>java.lang.String[]</code></li>
          
<li><b>Required</b>: <code>No</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3CexpectedSchemaFile.3E"></a><b><a name="expectedSchemaFile">&lt;expectedSchemaFile&gt;</a></b></h4>
        
<div>The schema XML file that contains the expected current schema.</div>
        
<ul>
          
<li><b>Type</b>: <code>java.io.File</code></li>
          
<li><b>Required</b>: <code>No</code></li>
          
<li><b>User Property</b>: <code>expectedSchemaFile</code></li>
          
<li><b>Default</b>: <code>${basedir}/src/main/permazen/current-schema.xml</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3CmatchNames.3E"></a><b><a name="matchNames">&lt;matchNames&gt;</a></b></h4>
        
<div>Whether to verify not only schema compatibility but also that the
two schemas are identical, i.e., the same names are used for object
types, fields, and composite indexes. 

<p>Two schemas that are equivalent except for names are considered
compatible, because the core API uses storage ID's, not names, to
encode fields. However, if names change then some Permazen layer
operations, such as index queries and reference path inversion, may
need to be updated.</p></div>
        
<ul>
          
<li><b>Type</b>: <code>boolean</code></li>
          
<li><b>Required</b>: <code>No</code></li>
          
<li><b>Default</b>: <code>true</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3ColdSchemasDirectory.3E"></a><b><a name="oldSchemasDirectory">&lt;oldSchemasDirectory&gt;</a></b></h4>
        
<div>The directory containing old schema versions still in use in any
existing databases.</div>
        
<ul>
          
<li><b>Type</b>: <code>java.io.File</code></li>
          
<li><b>Required</b>: <code>No</code></li>
          
<li><b>User Property</b>: <code>oldSchemasDirectory</code></li>
          
<li><b>Default</b>: <code>${basedir}/src/main/permazen/old</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3Cpackages.3E"></a><b><a name="packages">&lt;packages&gt;</a></b></h4>
        
<div>Specifies Java package names under which to search for classes with
@<code>PermazenType</code> or @<code>JFieldType</code> annotations.


<p>If no <code>&lt;classes&gt;</code> or
<code>&lt;packages&gt;</code> are configured, then by default this
plugin searches all classes in the output directory.</p></div>
        
<ul>
          
<li><b>Type</b>: <code>java.lang.String[]</code></li>
          
<li><b>Required</b>: <code>No</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3CschemaVersionProperty.3E"></a><b><a name="schemaVersionProperty">&lt;schemaVersionProperty&gt;</a></b></h4>
        
<div>The name of a Maven property to set to the auto-generated schema
version number. This is the schema version number that will be
auto-generated when a schema version number of <code>-1</code> is
configured. This auto-generated version number is based on hashing
the generated schema.</div>
        
<ul>
          
<li><b>Type</b>: <code>java.lang.String</code></li>
          
<li><b>Required</b>: <code>No</code></li>
        </ul><hr /></section><section>
<h4><a name="a.3CstorageIdGeneratorClass.3E"></a><b><a name="storageIdGeneratorClass">&lt;storageIdGeneratorClass&gt;</a></b></h4>
        
<div>
<p>The <code>StorageIdGenerator</code> to use for generating
Permazen storage ID's. By default, a
<code>DefaultStorageIdGenerator</code> is used.</p>

<p>To configure a custom <code>StorageIdGenerator</code>, specify
its class name like this:</p>

<blockquote>

<div>
<pre>
&lt;configuration&gt;
    &lt;storageIdGeneratorClass&gt;com.example.MyStorageIdGenerator&lt;/storageIdGeneratorClass&gt;
    ...
&lt;/configuration&gt;
</pre></div>
</blockquote>
The specified class (<code>com.example.MyStorageIdGenerator</code>
in this example) must be available either as part of the project
being built or in one of the project's dependencies.</div>
        
<ul>
          
<li><b>Type</b>: <code>java.lang.String</code></li>
          
<li><b>Required</b>: <code>No</code></li>
        </ul>
      </section></section>
    </section>
  

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2023..      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
